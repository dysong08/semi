<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="login+join_view.css">
</head>

<body>
    <article class="login_join">
        <!-- 로그인 + 회원가입 페이지 -->

        <fieldset>
            <section>
                <h1>로그인</h1>
                <input type="text" id="userId-login" placeholder="아이디를 입력해주세요."><br>
                <input type="password" id="userPwd-login" placeholder="비밀번호를 입력해주세요."><br>
                <div>
                    <input type="checkbox" id="userSaveStil"> <label for="">로그인 상태 유지</label>
                </div>
                <button onclick="login()">로그인</button>
                <a href="">아이디/비밀번호 찾기</a>
            </section>
        </fieldset>

        <fieldset>
            <section>
                <h1>회원가입</h1>
                <div>
                    <p>
                        지금 노스페이스 공식 멤버십회원으로 가입하시고,<br>
                        특별한 멤버십 혜택과 다양한 회원전용 상품을 만나보세요.
                    </p>
                    <ul>
                        <li>
                            <span>회원구매시 5%할인</span>
                        </li>
                        <li>
                            <span>5% 마일리지 적립</span>
                        </li>
                        <li>온오프 마일리지 통합</li>
                        <li>무료배송/반품/교환</li>
                        <li>생일 축하 할인쿠폰 지급</li>
                    </ul>
                </div>
            </section>
            <button id="benefit">혜택 더 보기</button>
            <button onclick="location.href='join.html'">회원가입</button>
        </fieldset>
    </article>


    <!-- <script>
        // 회원가입한 user 정보와 일치하면 login 성공 / 아니면 일치하지 않습니다.

        const login = () => {
            //getItem(key)

            const userIdValue = localStorage.getItem(userId.value);
            const userPwdValue = localStorage.getItem(userPwd.value);

            if (!(userIdValue && userPwdValue)) {
                alert("회원 정보가 일치하지 않습니다.");
            } else {
                alert("userName.value+님 반갑습니다!");
            }
        }
    </script> -->

    <!-- 로그인 상태 유지하기 join() -->





    <!-- 회원가입 입력창 -->
    <article class="join">
        <div class="block1">노스페이스 회원가입</div>

        <div class="block2">
            <fieldset class="block2-1">

                <div class="access-all">
                    <input type="checkbox" id="joinAgreeAll">

                    <div class="access-content-title">모든 약관 동의</div>
                </div>
                <div class="access-content-title">
                    아래 모든 약관(필수), 멤버십 이용약관(필수), 개인정보 수집 및 이용에 대한 동의(필수), 생년월일, 성별 제공에 대한 동의(선택) 및 광고성 정보수신 동의(선택)
                    내용을
                    확인하고 전체 동의합니다.
                </div>
                <p>
                    만 14세 이상에 한하여 노스페이스 온라인몰 이용약관, 개인정보 수집 및 이용동의, 멤버십 이용약관 동의 후 가입 가능하며 선택 항목에 대한 동의를 거부하더라도 온라인몰
                    회원가입
                    및 이용이 가능합니다.
                </p>

                <div class="access-content-title">
                    노스페이스 공식 온라인 스토어 회원 약관 및 개인정보 수집 이용에 대한 동의
                </div>
                <div class="access-member-terms">
                    <div>
                        <div class="checkBox-detail">
                            <input type="checkbox" name="joinAgree" id="joinAgree">
                            <span> (필수) 이용약관에 대한 동의</span>
                        </div>
                        <div class="checkBox-detail">
                            <input type="checkbox" name="joinAgree" id="joinAgree">
                            <span> (필수) 멤버십 이용약관에 대한 동의</span>
                        </div>
                        <div class="checkBox-detail">
                            <input type="checkbox" name="joinAgree" id="joinAgree">
                            <span> (필수) 개인정보 수집 및 이용에 대한 동의</span>
                        </div>
                        <div class="checkBox-detail">
                            <input type="checkbox" name="joinAgree" id="joinAgree">
                            <span> (선택) 생년월일, 성별 제공에 대한 동의</span>
                        </div>
                    </div>
                    <div>
                        <div class="access-link"><a href="#">전문보기</a></div>
                        <div class="access-link"><a href="#">전문보기</a></div>
                        <div class="access-link"><a href="#">보기</a></div>
                        <div class="access-link"><a href="#">보기</a></div>
                    </div>
                </div>
                <div class="add-Info-text warning-text">
                    <label>선택정보 제공 동의하지 않을 경우
                        <span>생일쿠폰 등의 멤버십 행사</span>
                        에서 제외 됩니다.</label>
                </div>


                <div class="access-content-title">광고성 정보 수신 동의</div>
                <article class="add-Info-text">
                    <span>다양한 이벤트 소식을 받아보세요</span>
                </article>

                <div class="access-ad">
                    <div class="access-ad-content">
                        <input type="checkbox" name="joinChoice" id="join">
                        <input type="checkbox" name="joinChoice" id="join">
                    </div>
                    <div class="access-ad-content">
                        <span>(선택) 쇼핑정보 E-mail 수신 동의</span>
                        <span>(선택) 쇼핑정보 SMS 수신 동의</span>
                    </div>
                </div>
            </fieldset>
            <hr style="opacity: 0.3;" />
            <fieldset class="block2-2">
                <h4>필수 입력 정보</h4>
                <p>본인 인증된 이름, 휴대폰번호로 가입됩니다.</p>
                <div class="info-main">
                    <div class="info-content">
                        <span>아이디</span>
                        <div class="info-input">
                            <input type="text" id="userId-join" placeholder="아이디를 입력해주세요.(특수문자 입력 불가)">
                            <div class="info-warning userIdText">영문, 숫자를 포함한 4~15자리로 입력해 주세요.</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>비밀번호</span>
                        <div class="info-input">
                            <input type="password" id="userPwd-join" placeholder="영문/숫자/특수문자 조합 8-16자">
                            <div class="info-warning userPwdText">영문/숫자/특수문자 조합 8-16자로 입력해 주세요.</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>비밀번호 확인</span>
                        <div class="info-input">
                            <input type="password" id="pwdChecked-join" placeholder="비밀번호 입력 확인">
                            <div class="info-warning pwdCheckedText">비밀번호가 일치하지 않습니다.</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>이메일</span>
                        <div class="info-input">
                            <input type="email" id="email" placeholder="이메일을 입력해주세요(abc@naver.com)">
                            <div class="info-warning email">email</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>이름</span>
                        <div class="info-input">
                            <input type="text" id="userName">
                            <div class="info-warning">name</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>휴대폰</span>
                        <div class="info-input">
                            <input type="number" id="userPhone" placeholder="(-)제외 숫자만 입력해주세요" maxlength="11">
                            <div class="info-warning">phone</div>
                        </div>
                    </div>

                    <div class="info-content">
                        <span>생년월일</span>
                        <div class="info-input">
                            <input type="date" id="userBirth">
                            <div class="info-warning">birth</div>
                        </div>
                    </div>


                </div>
                <article
                    style="color: #fd6d04; font-size: 0.8rem; margin-right: 40px;  display: flex; justify-content: end;">
                    생년월일, 성별 제공에
                    동의하지 않을 경우 저장되지
                    않습니다.</article>
            </fieldset>
        </div>
        <div class="block3">
            <button onclick="register()">회원가입</button>
        </div>
    </article>

    <!-- 회원가입 입력내용 유효성 확인작업 -->
    <script defer>

        const userIdRegExp = /^[a-zA-Z0-9]{4,15}$/;
        const userPwdRegExp = /^(?=.*[a-zA-Z])(?=.*\d)(?=.*[!@#$%^&*()])[A-Za-z\d!@#$%^&*()]{8,16}$/;
        const emailRegExp = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        const nameRegExp = /^[가-힣]+$/;
        const phoneRegExp = /^01[0-9]{9}$/;

        //id input 체크 값 ..
        const idVal = document.getElementById("userId-join");
        //id 조건 불일치 시 보여주기 위해..
        const idWarningText = document.querySelector(".userIdText");

        idVal.addEventListener('input', (e) => {
            if (e.target.value == "" || userIdRegExp.test(e.target.value)) {
                // id 정규식 통과 -> 경고문구 사라짐
                idWarningText.style.visibility = 'hidden';
            }
            else {
                // 정규식 통과 경고문구 안사라짐
                idWarningText.style.visibility = 'visible';
            }
        });

        //pwd input 체크 값..
        const pwdVal = document.getElementById("userPwd-join");
        //pwd 조건 불일치 시 보여줄 값..
        const pwdWarningText = document.querySelector(".userPwdText");

        pwdVal.addEventListener('input', (e) => {
            if (userPwdRegExp.test(e.target.value)) {
                //정규표현식 통과 -> 보여주던 경고문구를 사라지게 할 예정.
                pwdWarningText.style.visibility = 'hidden';
            }
            else {
                //정규표현식 통과 XX -> 경고문구 보여줄 예정
                pwdWarningText.style.visibility = 'visible';
            }
        })

        const emailVal = document.getElementById("email");
        const nameVal = document.getElementById("userName");
        const phoneVal = document.getElementById("userPhone");
        const birthVal = document.getElementById("userBirth")

        // pwd와 pwdChecked 일치여부 확인하여 경고문구 노출
        // pwdChecked의 값을 pwdCheckedVaL 변수에 담음


        // pwd와 pwdChecked 불일치하면 보여줄 문구
        const pwdCheckedVaL = document.getElementById("pwdChecked-join");
        const pwdCheckedWarningText = document.querySelector(".pwdCheckedText")

        pwdCheckedVaL.addEventListener('input', () => {
            if (pwdVal.value == pwdCheckedVaL.value) {
                //정규표현식 통과 -> 보여주던 경고문구를 사라지게 할 예정.
                pwdCheckedWarningText.style.visibility = 'hidden';
            }
            else {
                //정규표현식 통과 XX -> 경고문구 보여줄 예정
                pwdCheckedWarningText.style.visibility = 'visible';
            }
        })



        const register = () => {
            console.log("회원가입 버튼 눌림..");
            // 아이디가 없거나 잘못 입력
            if (!idVal.value || !userIdRegExp.test(idVal.value)) {
                alert("올바른 아이디를 입력해주세요.");
                return;
            }

            // 비밀번호가 없거나 잘못 입력
            if (!pwdVal.value || !userPwdRegExp.test(pwdVal.value)) {
                alert("올바른 비밀번호를 입력해주세요.");
                return;
            }
            // pwd와 pwdChecked 불일치시
            if (pwdVal.value != pwdCheckedVaL.value) {
                alert("비밀번호가 일치하지 않습니다.")
                return;
            }

            // 이메일 없거나 잘못입력
            if (!email.value || !emailRegExp.test(email.value)) {
                alert("올바른 이메일을 입력해주세요.");
                return;
            }
            // 이름이 없거나
            if (!userName.value || !nameRegExp.test(userName.value)) {
                alert("이름을 입력해주세요.")
                return;
            }

            // 휴대폰 없거나 잘못입력
            if (!userPhone.value || !phoneRegExp.test(userPhone.value)) {
                alert("(-)제외 숫자만 입력해주세요.")
                return;
            }
            // 생년월일 없거나
            if (!userBirth.value) {
                alert("생년월일을 입력해주세요.")
                return;
            }



            //..비밀번호.. 이메일.. 이름.. 등등 객체 추가
            const user = {
                id: idVal.value,
                pwd: pwdVal.value,
                email: emailVal.value,
                name: nameVal.value,
                phone: phoneVal.value,
                birth: birthVal.value,
                toString: function () {
                    return this.id + ", " + this.pwd + ", " + this.email + ", " + this.name + ", " + this.phone + ", " + this.birth;
                }

            }
            // const jsonStr = JSON.stringify(user);
            localStorage.setItem("user", JSON.stringify(user));
            console.log("user : " + user)

            const getUser = localStorage.getItem('user');
            console.log("user : " + getUser)

            alert(nameVal.value + "님! 가입을 축하드립니다!");
            location.replace("whole.html");



            // DB가 없으니까 잠시 로컬에 담아서 사용할 것인데,
            // 넣어준 이후에는 기존 데이터를 날려서 사용자에게 새로고침 현상과 같은
            // 시각 효과를 주는 것이 중요하다.
            // idVal.value = "";
            // pwdVal.value = "";

        }


        // 회원가입한 user 정보와 일치하면 login 성공 / 아니면 일치하지 않습니다.

        const login = () => {
            //getItem(key)


            const userIdValue = localStorage.getItem(idVal.value);
            console.log(idVal.value);



            console.log(userIdValue);
            const userPwdValue = localStorage.getItem(pwdVal.value);
            const userNameValue = localStorage.getItem(nameVal.value);


            // if ((idVal.value == true) && (pwdVal.value == true)) {
            //     alert(nameVal.value + "님 반갑습니다!");

            // } else {
            //     alert("회원 정보가 일치하지 않습니다.");
            //     console.log("로그인 실패");
            //     console.log(idVal.value);
            //     console.log(pwdVal.value);
            // }

            // if (!(idVal.value && pwdVal.value)) {
            //     alert("회원 정보가 일치하지 않습니다.");
            //     console+log("로그인 실패");
            // } else {
            //     alert(nameVal.value + "님 반갑습니다!");
            //     console.log(typeof userIdValue); // string
            //     console.log(typeof userPwdValue); // object
            //     console.log(typeof userPwdValue); // object

            //     console.log("name:" + name);
            //     console.log("nameVal.value:" + nameVal.value);
            //     console.log("userNameValue" + userNameValue);
            //     console.log("userNameValue.value:" + userNameValue.value);


            //     // ???????????왜안됌??????????????
            // }
        }


    </script>



</body>

</html>